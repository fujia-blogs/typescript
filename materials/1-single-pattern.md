# 单例设计模式

1，什么是设计模式？

2，常见的设计模式

- 单例设计
- 简单工厂
- 工厂方法
- 抽象工厂
- 观察者
- 装饰者
- 代理模式
- MVC
- MVP
- MVVM

3，单例模式

- 一个类对外只提供一个对象[实例]，且该类的内部提供了一个外部访问该对象的方法或该对象属性

4，应用场景

在一个应用中，有且只有一个类的实例，从而保证逻辑的正确性

举例：

- vuex, react-redux

在 MVVM 框架中，全局状态管理容器 store 对象

- 浏览器 localStorage

封装 localStorage 时，需要设计成一个单例

- 项目日志记录

为一个应用编写一个日志文件类，用来保存日志和读取日志信息，建议写出单例

## 静态成员

### 问答

1，外部如何调用 TS 类的静态成员？

类名直接调用静态成员

2，静态方法是否可以访问类中原型对象上的方法或对象属性，反过来呢？

都不能

3，对象变量是可以访问静态成员？

不能

4，静态成员保存在内存中哪里？什么时候分配的内存空间？

- 任何一个 TS 类中的静态成员存储在内存的静态区，运行一个 TS 类，TS 首先会为静态成员开辟内存空间，**静态成员的内存空间分配时间要早于对象空间的分配**
- 任何一个对象实例创建之前 TS 就已经为静态成员分配好了空间
- 一个静态方法只会分配一个空间，如果服务器不重启或应用不结束，静态方法会一直存在于内存空间中，无论调用多少次该静态方法，都会调用同一块空间

应用场景：数据不断改变，需要看到新的结果

5，new 一个 TS 类的方法可以吗？能在 TS 类外部使用 prototype 为 TS 类增加方法或属性吗？

- JS 中可以 new 一个类内部定义的对象方法或静态方法
- TS 屏蔽了 new 一个类中的方法，**TS 类可以访问 prototype 原型对象的属性，但不能在 prototype 原型对象属性增加新的方法或属性**，目的是防止回到 ES5 以前非面向类和对象的的写法

6，静态方法或属性和原型对象上的方法或属性的区别？

- 原型对象上的方法或属性是类实例公用的方法和属性
- 静态成员属于类，通过类直接访问
- 类实例创建之前已经为静态成员分配好了空间
- 一个静态方法或属性只会分配一个空间，而每一个对象都有自己独立的空间

7，静态方法可以接受一个对象变量来作为方法的参数吗？

可以，类的静态方法中不能通过 this 来访问对象属性和方法，但可以通过调用静态方法时把对象变量传递给静态方法使用

8，什么时候使用静态方法和静态属性？

- 单例设计模式
- 类中一个方法不需要使用任何实例属性和方法，且访问实例属性后导致该方法的逻辑不正确，可以将该方法设置为静态方法
- 创建类的实例没有意义，只需要使用类的一个或多个方法即可，如工具类的方法

### 示例：FileUtil 类

1，一个读取文件的方法，应该定义为静态方法吗？

建议定义成静态方法，静态方法实际上是一直保存到内存空间，这样反复操作其实节省了大量反复创建 和释放 FileUtil 对象的时间和对应的对象内存空间

## 要点

1，在类的静态方法中只能调用其它的静态成员，不可以访问实例属性或方法

2，在类中，一个静态方法改变了某个静态属性，其它静态方法或类外部任意地方访问这个属性都会发生改变

3，类的静态成员存储在内存中的**静态区**

4，无论是否创建对象，创建多少个对象，是否调用该静态方法或静态属性，TS 都会为该静态方法或属性分配内存空间，**tips：静态成员与对象无关**

5，一旦为静态方法或属性分配好空间，就一直保存在内存中，知道应用结束才被释放

6，静态方法对象变量本质也是一个函数对象变量

7，TS 中，可以修改类原型上已有的方法或属性，但不能新增
